#!/bin/bash
# List test directories that have an output file (indicating a failed test)

# Find the root of the project (c-xrefactory)
PROJECT_ROOT=$(git rev-parse --show-toplevel 2>/dev/null || echo "")
if [[ -z "$PROJECT_ROOT" || "$(basename "$PROJECT_ROOT")" != "c-xrefactory" ]]; then
  echo "Error: Script must be run from within the c-xrefactory project tree." >&2
  exit 1
fi

for dir in "$PROJECT_ROOT/tests/test_"*; do
    if [ -d "$dir" ] && [ -f "$dir/output" ]; then
        basename "$dir"
    fi
done
